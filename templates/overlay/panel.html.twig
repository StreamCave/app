{% extends 'base.html.twig' %}

{% block title %}Overlay
{% endblock %}


{% block body %}

	{# <div id="twitch-embed-content">
																																																																																								<div id="twitch-embed" class="twitch-embed-small">
																																																																																									<a href="#" id="btn_toggle_size_twitch">
																																																																																										<span class="iconify" data-icon="system-uicons:scale-extend"></span>
																																																																																									</a>
																																																																																								</div>
																																																																																							</div> #}


	<a href="#section_panels" id="btn-arrow-panels">
		<span class="iconify" data-icon="oi:arrow-circle-bottom"></span>
		<span>Acc√©der au panel</span>
	</a>

	<p>Vous vous situez sur le panel de
		<strong>{{overlay.OverlayOwner.pseudo}}</strong>.</p>
	<p>Si vous avez acc√®s √† cette page c'est que
		<strong>{{overlay.OverlayOwner.pseudo}}</strong>
		vous a donn√© acc√®s √† son panel pour son overlay :
		<strong style="font-size: 2rem">{{overlay.OverlayName}}</strong>
	</p>

	<section id="overlay_show_access_person">
		<h2>Qui a acc√®s √† mon overlay ?</h2>
		<p>Toutes les personnes qui ont acc√®s √† votre overlay sont list√©s ci-dessous.</p>
		<div class="flex">
			{% if overlay.OverlayAccess.snapshot is not null %}
				{% for person in overlay.OverlayAccess.snapshot %}
					{% if person.pseudo != "Websocket" %}
						<div class="avatar">
							<img src="{{person.avatarURL != null ? person.avatarURL : 'https://cdn.artaic.fr/images/Blason-Salty.png'}}" alt="Avatar de {{person.pseudo}}" title="Avatar de {{person.pseudo}}">
							<p>{{person.pseudo != app.user.pseudo ? person.pseudo : 'Vous' }}</p>
						</div>
					{% endif %}
				{% endfor %}
			{% endif %}
		</div>
		{% if is_granted('OVERLAY_EDIT', overlay) %}
			<a class="btn btn-warning" href="{{ path('app_overlay_edit', {'id': overlay.id}) }}">
				<span class="iconify" data-icon="bxs:edit"></span>Editer les permission</a>
		{% endif %}

	</section>


	<div id="overlay_show" class="btn-section">
		<div class="row">
			<div class="col">
				<p>Vous pouvez acc√©der au
					<strong>browsersource</strong>
					de cette overlay en cliquant le sur lien suivant.</p>
				<p>
					<em>Ca ouvrira un nouvel onglet üòâ</em>
				</p>
				<a href="{{ path('app_overlay_show_browsersource', {'id': overlay.id}) }}" target="_blank" class="btn btn-info" style="width: 100%">Acc√©der au browsersource</a>
				<a class="btn btn-danger" style="width: 100%" onclick="refreshBrowsersource()">Rafraichir le browsersource</a>
			</div>
			<div class="col">
				<p>Vous pouvez cliquer sur le bouton suivant afin de copier le lien de votre browsersource.</p>
				<p>
					<u>Ce lien sera √† coller sur votre OBS Studio, Streamlabs ou logiciel similaire afin d'avoir votre rendu.</u>
				</p>
				<button class="btn btn-warning" style="width: 100%" onclick="copierTexte(this, event)" value="https://v4.dev.symfony.artaic.fr{{ path('app_overlay_show_browsersource', {'id': overlay.id}) }}">Copier le browsersource</button>
			</div>
		</div>
	</div>

	<section id="overlay_show" class="container">
		<pre>
		{{ dump(widgets) }}
	</pre>


		{% if is_granted('ROLE_ADMIN') %}
			<h3>Informations sur les widgets :</h3>
			<table class="table">
				<thead>
					<tr>
						<th>Nom</th>
						<th>Etat</th>
						<th>D√©tails</th>
					</tr>
				</thead>
				<tbody>
					{% for item in redmine_widgets %}
						<tr>
							<td>{{item.subject}}</td>
							<td>
								{% if item.status["name"] == "Nouveau" %}
									<span class="badge bg-info">Nouveau</span>
								{% endif %}
								{% if item.status["name"] == "En cours" %}
									<span class="badge bg-dark text-light">En cours de d√©v</span>
								{% endif %}
								{% if item.status["name"] == "Online" %}
									<span class="badge bg-success">OK - Online</span>
								{% endif %}
								{% if item.status["name"] == "Attent WS" %}
									<span class="badge bg-warning">Attente WS</span>
								{% endif %}
								{% if item.status["name"] == "HS" %}
									<span class="badge bg-danger">Hors service</span>
								{% endif %}
							</td>
							<td>
								<p>{{item.description}}</p>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		{% endif %}

		<pre>
			{{ dump(app.request) }}
		</pre>

		<div id="panel_widgets">
			<section id="section_btn_panel">
				<div id="panel_btn_event" class="btn_panel">Event</div>
				<div id="panel_btn_match" class="btn_panel active">Match</div>
				<div id="panel_btn_popup" class="btn_panel">Popup</div>
				<div id="panel_btn_tweets" class="btn_panel">Tweets</div>
			</section>

			<section id="section_panels">
				<div id="panel_event" class="display_none">
					<h3>G√©rer l'√©v√©nement en cours</h3>


					<hr>
					<div class="container">
						{% if event_service.getOneCurrentEvent %}
							{% set event = event_service.getOneCurrentEvent[0] %}
							{{ include('event/components/event_card.html.twig') }}
							<a class="btn btn-warning" href="{{ path('app_event_edit', {'id': event.id, 'id_overlay': overlay.id}) }}">
								<span class="iconify" data-icon="bxs:edit"></span>Modifier cet √©v√©nement</a>
						{% else %}
							<p>Aucun √©v√©nement en cours</p>

							<a class="btn btn-info btn-full" href="{{ path('app_event_new') }}">
								<span class="iconify" data-icon="akar-icons:circle-plus-fill"></span>Cr√©er un nouvel √©v√©nement</a>
						{% endif %}
					</div>
				</div>
				<div id="panel_match">
					<h3>G√©rer le match en cours</h3>


					<hr>
					<div class="container">
						{{ include('overlay/forms/_form-topbar-title.html.twig', {'button_label': 'Mettre √† jour'}) }}

						{% if game_service.getOneCurrentGame %}
							{% set game = game_service.getOneCurrentGame[0] %}
							<div class="center_element">
								{{ include('components/card_match.html.twig') }}
							</div>
						{% else %}
							<p>Aucun match en cours</p>

							<a class="btn btn-info btn-full" href="{{ path('app_game_new') }}">
								<span class="iconify" data-icon="akar-icons:circle-plus-fill"></span>Cr√©er un nouveau match</a>
						{% endif %}

					</div>
				</div>
				<div id="panel_popup" class="display_none">
					<div class="container">
						{{ include('overlay/forms/_form-popup.html.twig', {'button_label': 'Mettre √† jour'}) }}
					</div>
					<div class="container">
						{{ include('overlay/forms/_form-bottombar-marquee.html.twig', {'button_label': 'Mettre √† jour'}) }}
					</div>
				</div>
				<div id="panel_tweets" class="display_none">
					<h3>G√©rer les tweets</h3>


					<hr>
					<div class="container">
						{{ include('overlay/forms/_form-tweet-hashtag.html.twig', {'button_label': 'Mettre √† jour'}) }}
						<button class="btn btn-info btn-icon-append btn-full" onclick="gettweets()" data-toggle="modal" data-target="#exampleModal" type="button">
							<span class="iconify" data-icon="akar-icons:twitter-fill"></span>
							Voir les tweets</button>
					</div>
				</div>
			</section>
		</div>

		<div class="row">
			<div class="col">
				<h3>Widgets de l'overlay</h3>
				<p>Retrouvez la liste des widgets qui appartiennent √† l'overlay "{{overlay.OverlayName}}"</p>
				<table class="table">
					<thead>
						<tr>
							{% if is_granted('ROLE_ADMIN') %}
								<th>Id</th>
							{% endif %}
							<th>Nom</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for widget in widgets %}
							<tr>
								{% if is_granted('ROLE_ADMIN') %}
									<td>{{ widget.id }}</td>
								{% endif %}
								<td>{{ widget.WidgetName }}</td>
								<td>
									<a class="btn btn-warning" href="{{ path('app_widgets_edit', {'id': widget.id, 'id_overlay': overlay.id}) }}">
										<span class="iconify" data-icon="bxs:edit"></span>Editer</a>
								</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="8">Aucune donn√©e</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
				<a class="btn btn-info" href="{{ path('app_widgets_new', {'id_overlay': overlay.id}) }}">
					<span class="iconify" data-icon="akar-icons:circle-plus-fill"></span>
					Ajouter un widget</a>
			</div>
			<div class="col">
				<h3>Metadonn√©es de l'overlay</h3>
				<p>Vous pouvez retrouvez la liste des m√©tadonn√©es de l'overlay "{{overlay.OverlayName}}"</p>
				<table class="table">
					<thead>
						<tr>
							{% if is_granted('ROLE_ADMIN') %}
								<th>Id</th>
							{% endif %}
							<th>Cl√©</th>
							<th>Valeur</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for meta in metas %}
							<tr>
								<td>{{ meta.id }}</td>
								<td>{{ meta.MetaKey }}</td>
								<td>{{ meta.MetaValue }}</td>
								<td>
									<a class="btn btn-warning" href="{{ path('app_meta_edit', {'id': meta.id, 'id_overlay': overlay.id}) }}">
										<span class="iconify" data-icon="bxs:edit"></span>Editer</a>
								</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="4">Aucune donn√©e</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
				<a class="btn btn-info" href="{{ path('app_meta_new') }}">
					<span class="iconify" data-icon="akar-icons:circle-plus-fill"></span>
					Ajouter une m√©tadonn√©e</a>
			</div>
		</div>
	</section>
	{{ include('components/modal_tweets.html.twig') }}{{ include('components/modal_reset.html.twig') }}
{% endblock %}
