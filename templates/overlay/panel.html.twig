{% extends 'base.html.twig' %}

{% block title %}Overlay
{% endblock %}


{% block body %}

	<div id="twitch-embed-content">
		<div id="twitch-embed" class="twitch-embed-small">
			<a href="#" id="btn_toggle_size_twitch">
				<span class="iconify" data-icon="system-uicons:scale-extend"></span>
			</a>
		</div>
	</div>


	<p>Vous vous situez sur le panel de
		<strong>{{overlay.OverlayOwner.pseudo}}</strong>.</p>
	<p>Si vous avez acc√®s √† cette page c'est que
		<strong>{{overlay.OverlayOwner.pseudo}}</strong>
		vous a donn√© acc√®s √† son panel pour son overlay :
		<strong style="font-size: 2rem">{{overlay.OverlayName}}</strong>
	</p>

	<section id="overlay_show_access_person">
		<h2>Qui a acc√®s √† mon overlay ?</h2>
		<p>Toutes les personnes qui ont acc√®s √† votre overlay sont list√©s ci-dessous.</p>
		<div class="flex">
			{% if overlay.OverlayAccess.snapshot is not null %}
				{% for person in overlay.OverlayAccess.snapshot %}
					{% if person.pseudo != "Websocket" %}
						<div class="avatar">
							<img src="{{person.avatarURL != null ? person.avatarURL : 'https://cdn.artaic.fr/images/Blason-Salty.png'}}" alt="Avatar de {{person.pseudo}}" title="Avatar de {{person.pseudo}}">
							<p>{{person.pseudo != app.user.pseudo ? person.pseudo : 'Vous' }}</p>
						</div>
					{% endif %}
				{% endfor %}
			{% endif %}
		</div>
		<a class="btn btn-warning" href="{{ path('app_overlay_edit', {'id': overlay.id}) }}">
			<span class="iconify" data-icon="bxs:edit"></span>Editer les permission</a>
	</section>


	<div id="overlay_show" class="btn-section">
		<div class="row">
			<div class="col">
				<p>Vous pouvez acc√©der au
					<strong>browsersource</strong>
					de cette overlay en cliquant le sur lien suivant.</p>
				<p>
					<em>Ca ouvrira un nouvel onglet üòâ</em>
				</p>
				<a href="{{ path('app_overlay_show_browsersource', {'id': overlay.id}) }}" target="_blank" class="btn btn-info" style="width: 100%">Acc√©der au browsersource</a>
			</div>
			<div class="col">
				<p>Vous pouvez cliquer sur le bouton suivant afin de copier le lien de votre browsersource.</p>
				<p>
					<u>Ce lien sera √† coller sur votre OBS Studio, Streamlabs ou logiciel similaire afin d'avoir votre rendu.</u>
				</p>
				<button class="btn btn-warning" style="width: 100%" onclick="copierTexte(this, event)" value="https://v4.dev.symfony.artaic.fr{{ path('app_overlay_show_browsersource', {'id': overlay.id}) }}">Copier le browsersource</button>
			</div>
		</div>
	</div>

	<section id="overlay_show" class="container">
		<div class="row">
			<div class="col">
				<h3>Widgets de l'overlay</h3>
				<p>Retrouvez la liste des widgets qui appartiennent √† l'overlay "{{overlay.OverlayName}}"</p>
				<table class="table">
					<thead>
						<tr>
							{% if is_granted('ROLE_ADMIN') %}
								<th>Id</th>
							{% endif %}
							<th>Nom</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for widget in widgets %}
							<tr>
								{% if is_granted('ROLE_ADMIN') %}
									<td>{{ widget.id }}</td>
								{% endif %}
								<td>{{ widget.WidgetName }}</td>
								<td>
									<a class="btn btn-warning" href="{{ path('app_widgets_edit', {'id': widget.id, 'id_overlay': overlay.id}) }}">
							<span class="iconify" data-icon="bxs:edit"></span>Editer</a>
								</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="8">Aucune donn√©e</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
				<a class="btn btn-info" href="{{ path('app_widgets_new', {'id_overlay': overlay.id}) }}">
					<span class="iconify" data-icon="akar-icons:circle-plus-fill"></span>
					Ajouter un widget</a>
			</div>
			<div class="col">
				<h3>Metadonn√©es de l'overlay</h3>
				<p>Vous pouvez retrouvez la liste des m√©tadonn√©es de l'overlay "{{overlay.OverlayName}}"</p>
				<table class="table">
					<thead>
						<tr>
							{% if is_granted('ROLE_ADMIN') %}
								<th>Id</th>
							{% endif %}
							<th>Cl√©</th>
							<th>Valeur</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						{% for meta in metas %}
							<tr>
								<td>{{ meta.id }}</td>
								<td>{{ meta.MetaKey }}</td>
								<td>{{ meta.MetaValue }}</td>
								<td>
									<a class="btn btn-warning" href="{{ path('app_meta_edit', {'id': meta.id, 'id_overlay': overlay.id}) }}">
							<span class="iconify" data-icon="bxs:edit"></span>Editer</a>
								</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="4">Aucune donn√©e</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
				<a class="btn btn-info" href="{{ path('app_meta_new') }}">
					<span class="iconify" data-icon="akar-icons:circle-plus-fill"></span>
					Ajouter une m√©tadonn√©e</a>
			</div>
		</div>
	</section>


{% endblock %}
